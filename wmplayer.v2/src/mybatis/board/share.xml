<?xml version="1.0" encoding="UTF-8"?><!--Converted at: Mon Aug 24 10:49:32
	KST 2015 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="share">
	<sql id="weather">
		<foreach collection="weather_custom" item="item" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</sql>

	<insert id="insert" parameterType="kr.co.wmplayer.sinmina.model.dto.board.BoardUserDTO">
		insert into board_user
		values (share_seq.nextval, #{userid}, #{board_title}, #{board_artist}, #{videoid},
			#{albumcover}, #{weather_custom}, sysdate, #{board_desc}, 0)
	</insert>

	<update id="update" parameterType="hashmap">
		update share
		<trim prefix="set" suffixOverrides=",">
			<choose>
				<when test="action == 'count'">view_cnt = view_cnt + 1</when>
				<when test="action == 'update'"></when>
			</choose>
		</trim>
		where share_seq = #{share_seq}
	</update>

	<select id="select" resultType="kr.co.wmplayer.sinmina.model.dto.board.BoardUserDTO">
		select ${select_column}
		from board_user
		<trim prefix="where">
			<if test="get == 'one'">${compare_column} = #{value}</if>
			<if test="get == 'all'">
				weather_custom in
				<include refid="weather"/>
			</if>
		</trim>
		<trim prefix="order by" suffix="desc">
			<if test="get == 'ten'">view_count</if>
			<if test="get == 'all'">board_seq</if>
		</trim>
	</select>

	<update id="updatecnt" parameterType="int">
		update board_user
		set check_cnt = check_cnt + 1
		where board_seq=#{board_seq}
	</update>

	<select id="selectPop" resultType="kr.co.wmplayer.sinmina.model.dto.board.BoardUserDTO">
		select board_seq, board_title, board_artist, userID, albumcover
		from board_user
		where rownum between 1 and 10
		order by check_cnt desc
	</select>

	<select id="myboard" parameterType="String" resultType="kr.co.wmplayer.sinmina.model.dto.board.BoardUserDTO">
		select board_seq, board_title, board_artist from board_user
		where userID=#{userID}
	</select>

	<!-- 리플관련 -->
	<select id="countReple" parameterType="int" resultType="String">
		select count(*)
		from shareReple
		where share_seq=#{share_seq}
	</select>

	<update id="updateReple" parameterType="java.util.HashMap">
		update shareReple
		set contents=#{updatedContents}
		where shareReple_seq=#{upNum}
	</update>

	<delete id="deleteReple" parameterType="int">
		delete from shareReple
		where shareReple_seq=#{delNum}
	</delete>

	<insert id="inReple" parameterType="kr.co.wmplayer.sinmina.model.dto.board.BoardUserDTO">
		insert into shareReple
		values (shareReple_seq.nextval, #{share_seq}, #{contents}, #{userID}, SYSDATE)
	</insert>

	<select id="repleSelectAll" parameterType="int" resultType="kr.co.wmplayer.sinmina.model.dto.board.BoardUserDTO">
		select *
		from shareReple
		where share_seq=#{share_seq}
		order by submit_date desc
	</select>
</mapper>